# Template VAE configuration.
defaults:
  - _self_

_target_: src.algorithms.vae.VAE
features:
  _target_: src.algorithms.components.features.FeaturesFromCkpt
  ckpt_path: ???
  attr: model
  litmodule_cls:
    _target_: hydra.utils.get_class
    path: src.algorithms.vicreg.VICReg

mask: false

encoder:
  _target_: src.algorithms.components.encoder.VariationalEncoder
  in_dim: 10
  nodes: [9, 6]
  out_dim: 4

decoder:
  _target_: src.algorithms.components.decoder.Decoder
  in_dim: ${algorithm.encoder.out_dim}
  nodes: [6, 9]
  out_dim: ${algorithm.encoder.in_dim}

loss:
  _target_: src.losses.vae.ClassicVAELoss
  scale: 1
  kl_scale: 0.001

# Annealing of the KL scale scalar.
kl_warmup_frac: 0.2

optimizer:
  _partial_: true
  _target_: torch.optim.AdamW
  lr: 0.001
  weight_decay: 0.0
  betas: [0.9, 0.999]
  eps: 1e-8
