# @package _global_

defaults:
  - override /data: axov6
  - override /algorithm: vae
  - override /callbacks: default
  - override /trainer: gpu0
  - override /evaluator: default
  - override /evaluator_callbacks: default
  - override /logger: mlflow

seed: 123
tags: ["axo_v6", "vae"]

experiment_name: vae
run_name: test


callbacks:

  anomaly_rate:
    metric_names: ["loss/reco/full", "loss/kl/full"]

  max_rate_kl:
    _target_: src.callbacks.model_checkpoint.SingleDatasetModelCheckpoint
    dirpath: '${paths.checkpoints_dir}/${experiment_name}/${run_name}'
    monitor: loss_kl_full_rate0.25
    criterion:
      _target_: src.callbacks.checkpointing.criterion.Max
      top_k: 1

  max_rate_reco:
    _target_: src.callbacks.model_checkpoint.SingleDatasetModelCheckpoint
    dirpath: '${paths.checkpoints_dir}/${experiment_name}/${run_name}'
    monitor: loss_reco_full_rate0.25
    criterion:
      _target_: src.callbacks.checkpointing.criterion.Max
      top_k: 1


evaluator:

  ckpts:
    last: null
    single:
      loss: ['min']
      loss_kl_full_rate0.25: ['max']
      loss_reco_full_rate0.25: ['max']



